[
  { "question": "What is the latest block number?", "sql": "SELECT max(number) AS latest_block FROM blocks" },
  { "question": "最新区块高度是多少？", "sql": "SELECT max(number) AS latest_block FROM blocks" },
  { "question": "How many blocks were produced in the last 24 hours?", "sql": "SELECT count(*) AS block_count FROM blocks WHERE timestamp > NOW() - INTERVAL '24 hours'" },
  { "question": "Show me the 10 most recent blocks with their gas usage", "sql": "SELECT number, gas_used, gas_limit, timestamp FROM blocks ORDER BY number DESC LIMIT 10" },
  { "question": "Average block time over the last 1000 blocks", "sql": "WITH recent AS (\n    SELECT number, timestamp,\n           LAG(timestamp) OVER (ORDER BY number) AS prev_ts\n    FROM blocks\n    ORDER BY number DESC\n    LIMIT 1000\n)\nSELECT AVG(EXTRACT(EPOCH FROM (timestamp - prev_ts))) AS avg_block_time_seconds\nFROM recent\nWHERE prev_ts IS NOT NULL" },
  { "question": "过去一小时每个区块的平均 gas 使用率", "sql": "SELECT AVG(gas_used::numeric / NULLIF(gas_limit, 0)) AS avg_gas_utilization\nFROM blocks\nWHERE timestamp > NOW() - INTERVAL '1 hour'\nAND gas_limit > 0" },
  { "question": "How many transactions in the last 24 hours?", "sql": "SELECT count(*) AS tx_count FROM transactions WHERE block_timestamp > NOW() - INTERVAL '24 hours'" },
  { "question": "过去24小时的交易数量", "sql": "SELECT count(*) AS tx_count FROM transactions WHERE block_timestamp > NOW() - INTERVAL '24 hours'" },
  { "question": "Show me the top 10 addresses by transaction count", "sql": "SELECT '0x' || encode(from_address_hash, 'hex') AS address,\n       count(*) AS tx_count\nFROM transactions\nGROUP BY from_address_hash\nORDER BY tx_count DESC\nLIMIT 10" },
  { "question": "过去7天交易量最大的合约地址", "sql": "SELECT '0x' || encode(to_address_hash, 'hex') AS contract_address,\n       count(*) AS tx_count\nFROM transactions\nWHERE block_timestamp > NOW() - INTERVAL '7 days'\n  AND to_address_hash IS NOT NULL\nGROUP BY to_address_hash\nORDER BY tx_count DESC\nLIMIT 20" },
  { "question": "What is the total FLOW transferred in the last 24 hours?", "sql": "SELECT SUM(value) / 1e18 AS total_flow_transferred\nFROM transactions\nWHERE block_timestamp > NOW() - INTERVAL '24 hours'\n  AND status = 1" },
  { "question": "Transaction success rate over the last 24 hours", "sql": "SELECT\n    count(*) AS total,\n    count(*) FILTER (WHERE status = 1) AS success,\n    count(*) FILTER (WHERE status = 0) AS failed,\n    ROUND(100.0 * count(*) FILTER (WHERE status = 1) / NULLIF(count(*), 0), 2) AS success_rate_pct\nFROM transactions\nWHERE block_timestamp > NOW() - INTERVAL '24 hours'" },
  { "question": "Show me the largest transactions by value in the last 7 days", "sql": "SELECT '0x' || encode(hash, 'hex') AS tx_hash,\n       '0x' || encode(from_address_hash, 'hex') AS from_addr,\n       '0x' || encode(to_address_hash, 'hex') AS to_addr,\n       value / 1e18 AS flow_value,\n       block_timestamp\nFROM transactions\nWHERE block_timestamp > NOW() - INTERVAL '7 days'\n  AND status = 1\nORDER BY value DESC\nLIMIT 20" },
  { "question": "Daily transaction count for the past 30 days", "sql": "SELECT DATE(block_timestamp) AS day,\n       count(*) AS tx_count\nFROM transactions\nWHERE block_timestamp > NOW() - INTERVAL '30 days'\nGROUP BY DATE(block_timestamp)\nORDER BY day" },
  { "question": "过去30天每天的交易数量趋势", "sql": "SELECT DATE(block_timestamp) AS day,\n       count(*) AS tx_count\nFROM transactions\nWHERE block_timestamp > NOW() - INTERVAL '30 days'\nGROUP BY DATE(block_timestamp)\nORDER BY day" },
  { "question": "List all ERC-20 tokens ordered by holder count", "sql": "SELECT '0x' || encode(contract_address_hash, 'hex') AS token_address,\n       name, symbol, holder_count, decimals\nFROM tokens\nWHERE type = 'ERC-20'\nORDER BY holder_count DESC NULLS LAST\nLIMIT 50" },
  { "question": "Show me top 10 WFLOW holders", "sql": "SELECT '0x' || encode(actb.address_hash, 'hex') AS holder_address,\n       actb.value / POWER(10, COALESCE(t.decimals, 18)) AS balance,\n       actb.block_number\nFROM address_current_token_balances actb\nJOIN tokens t ON t.contract_address_hash = actb.token_contract_address_hash\nWHERE t.symbol = 'WFLOW'\n  AND actb.value > 0\nORDER BY actb.value DESC\nLIMIT 10" },
  { "question": "WFLOW 的 top 10 holders 是谁？", "sql": "SELECT '0x' || encode(actb.address_hash, 'hex') AS holder_address,\n       actb.value / POWER(10, COALESCE(t.decimals, 18)) AS balance,\n       actb.block_number\nFROM address_current_token_balances actb\nJOIN tokens t ON t.contract_address_hash = actb.token_contract_address_hash\nWHERE t.symbol = 'WFLOW'\n  AND actb.value > 0\nORDER BY actb.value DESC\nLIMIT 10" },
  { "question": "How many unique holders does a specific token have?", "sql": "SELECT t.symbol, t.name,\n       count(*) AS holder_count\nFROM address_current_token_balances actb\nJOIN tokens t ON t.contract_address_hash = actb.token_contract_address_hash\nWHERE t.symbol = 'WFLOW'\n  AND actb.value > 0\nGROUP BY t.symbol, t.name" },
  { "question": "Show me all ERC-721 (NFT) collections", "sql": "SELECT '0x' || encode(contract_address_hash, 'hex') AS token_address,\n       name, symbol, holder_count, total_supply\nFROM tokens\nWHERE type = 'ERC-721'\nORDER BY holder_count DESC NULLS LAST\nLIMIT 50" },
  { "question": "Token transfer volume in the last 24 hours grouped by token", "sql": "SELECT t.symbol, t.name,\n       count(*) AS transfer_count,\n       count(DISTINCT tt.from_address_hash) AS unique_senders,\n       count(DISTINCT tt.to_address_hash) AS unique_receivers\nFROM token_transfers tt\nJOIN tokens t ON t.contract_address_hash = tt.token_contract_address_hash\nJOIN blocks b ON b.number = tt.block_number\nWHERE b.timestamp > NOW() - INTERVAL '24 hours'\nGROUP BY t.symbol, t.name\nORDER BY transfer_count DESC\nLIMIT 20" },
  { "question": "过去24小时 token 转账次数最多的代币", "sql": "SELECT t.symbol, t.name,\n       count(*) AS transfer_count\nFROM token_transfers tt\nJOIN tokens t ON t.contract_address_hash = tt.token_contract_address_hash\nJOIN blocks b ON b.number = tt.block_number\nWHERE b.timestamp > NOW() - INTERVAL '24 hours'\nGROUP BY t.symbol, t.name\nORDER BY transfer_count DESC\nLIMIT 20" },
  { "question": "Top 10 addresses by native FLOW balance", "sql": "SELECT '0x' || encode(hash, 'hex') AS address,\n       fetched_coin_balance / 1e18 AS flow_balance,\n       transactions_count\nFROM addresses\nWHERE fetched_coin_balance IS NOT NULL\nORDER BY fetched_coin_balance DESC\nLIMIT 10" },
  { "question": "FLOW 余额最多的前10个地址", "sql": "SELECT '0x' || encode(hash, 'hex') AS address,\n       fetched_coin_balance / 1e18 AS flow_balance,\n       transactions_count\nFROM addresses\nWHERE fetched_coin_balance IS NOT NULL\nORDER BY fetched_coin_balance DESC\nLIMIT 10" },
  { "question": "How many unique addresses have transacted on Flow EVM?", "sql": "SELECT count(DISTINCT from_address_hash) AS unique_senders,\n       count(DISTINCT to_address_hash) AS unique_receivers\nFROM transactions" },
  { "question": "New addresses created per day for the last 30 days", "sql": "SELECT DATE(inserted_at) AS day,\n       count(*) AS new_addresses\nFROM addresses\nWHERE inserted_at > NOW() - INTERVAL '30 days'\nGROUP BY DATE(inserted_at)\nORDER BY day" },
  { "question": "How many verified smart contracts are there?", "sql": "SELECT count(*) AS verified_contracts FROM smart_contracts" },
  { "question": "List the most recently verified contracts", "sql": "SELECT '0x' || encode(address_hash, 'hex') AS contract_address,\n       name, compiler_version, optimization, inserted_at\nFROM smart_contracts\nORDER BY inserted_at DESC\nLIMIT 20" },
  { "question": "What is the current indexing status?", "sql": "SELECT 'latest_block' AS metric, max(number)::text AS value FROM blocks\nUNION ALL\nSELECT 'missing_ranges', count(*)::text FROM missing_block_ranges\nUNION ALL\nSELECT 'pending_block_ops', count(*)::text FROM pending_block_operations" },
  { "question": "索引器状态如何？", "sql": "SELECT 'latest_block' AS metric, max(number)::text AS value FROM blocks\nUNION ALL\nSELECT 'missing_ranges', count(*)::text FROM missing_block_ranges\nUNION ALL\nSELECT 'pending_block_ops', count(*)::text FROM pending_block_operations" },
  { "question": "Show database table sizes", "sql": "SELECT relname AS table_name,\n       pg_size_pretty(pg_total_relation_size(relid)) AS total_size\nFROM pg_catalog.pg_statio_user_tables\nORDER BY pg_total_relation_size(relid) DESC\nLIMIT 20" },
  { "question": "How many unfetched token balances are pending?", "sql": "SELECT count(*) AS unfetched_balances\nFROM address_token_balances\nWHERE value_fetched_at IS NULL" },
  { "question": "Token balance sync lag — tokens where current balances lag behind transfers", "sql": "WITH transfers AS (\n    SELECT token_contract_address_hash, max(block_number) AS tmax\n    FROM token_transfers\n    GROUP BY token_contract_address_hash\n),\ncurrent_bal AS (\n    SELECT token_contract_address_hash, max(block_number) AS cmax\n    FROM address_current_token_balances\n    GROUP BY token_contract_address_hash\n)\nSELECT '0x' || encode(tr.token_contract_address_hash, 'hex') AS token,\n       t.symbol,\n       tr.tmax AS transfers_max_block,\n       COALESCE(cb.cmax, 0) AS balance_max_block,\n       tr.tmax - COALESCE(cb.cmax, 0) AS lag_blocks\nFROM transfers tr\nLEFT JOIN current_bal cb USING (token_contract_address_hash)\nLEFT JOIN tokens t ON t.contract_address_hash = tr.token_contract_address_hash\nWHERE tr.tmax - COALESCE(cb.cmax, 0) > 0\nORDER BY lag_blocks DESC\nLIMIT 20" },
  { "question": "Show all API rate limit plans", "sql": "SELECT name, max_req_per_second\nFROM account_api_plans\nORDER BY max_req_per_second" },
  { "question": "How many users are on each API plan?", "sql": "SELECT COALESCE(p.name, 'No Plan') AS plan,\n       COALESCE(p.max_req_per_second::text, 'N/A') AS limit_per_sec,\n       count(i.id) AS user_count\nFROM account_identities i\nLEFT JOIN account_api_plans p ON i.plan_id = p.id\nGROUP BY p.name, p.max_req_per_second\nORDER BY CASE WHEN p.max_req_per_second IS NULL THEN 0 ELSE p.max_req_per_second END" },
  { "question": "Top 10 internal transaction value transfers in the last 24 hours", "sql": "SELECT '0x' || encode(transaction_hash, 'hex') AS tx_hash,\n       '0x' || encode(from_address_hash, 'hex') AS from_addr,\n       '0x' || encode(to_address_hash, 'hex') AS to_addr,\n       value / 1e18 AS flow_value,\n       type, call_type\nFROM internal_transactions\nWHERE block_number >= (SELECT max(number) - 28800 FROM blocks)\n  AND value > 0\nORDER BY value DESC\nLIMIT 10" },
  { "question": "How many log events in the last 24 hours?", "sql": "SELECT count(*) AS log_count\nFROM logs\nWHERE block_number >= (SELECT max(number) - 28800 FROM blocks)" }
]
